{"version":3,"file":"background.js","sources":["app/lib/window.js","app/env.js","app/background.js"],"sourcesContent":["// This helper remembers the size and position of your windows (and restores\r\n// them in that place after app relaunch).\r\n// Can be used for more than one window, just construct many\r\n// instances of it and give each different name.\r\n\r\nimport { app, BrowserWindow, screen } from 'electron';\r\nimport jetpack from 'fs-jetpack';\r\n\r\nexport default function (name, options) {\r\n\r\n  var userDataDir = jetpack.cwd(app.getPath('userData'));\r\n  var stateStoreFile = 'window-state-' + name +'.json';\r\n  var defaultSize = {\r\n    width: options.width,\r\n    height: options.height\r\n  };\r\n  var state = {};\r\n  var win;\r\n\r\n  var restore = function () {\r\n    var restoredState = {};\r\n    try {\r\n      restoredState = userDataDir.read(stateStoreFile, 'json');\r\n    } catch (err) {\r\n      // For some reason json can't be read (might be corrupted).\r\n      // No worries, we have defaults.\r\n    }\r\n    return Object.assign({}, defaultSize, restoredState);\r\n  };\r\n\r\n  var getCurrentPosition = function () {\r\n    var position = win.getPosition();\r\n    var size = win.getSize();\r\n    return {\r\n      x: position[0],\r\n      y: position[1],\r\n      width: size[0],\r\n      height: size[1]\r\n    };\r\n  };\r\n\r\n  var windowWithinBounds = function (windowState, bounds) {\r\n    return windowState.x >= bounds.x &&\r\n      windowState.y >= bounds.y &&\r\n      windowState.x + windowState.width <= bounds.x + bounds.width &&\r\n      windowState.y + windowState.height <= bounds.y + bounds.height;\r\n  };\r\n\r\n  var resetToDefaults = function (windowState) {\r\n    var bounds = screen.getPrimaryDisplay().bounds;\r\n    return Object.assign({}, defaultSize, {\r\n      x: (bounds.width - defaultSize.width) / 2,\r\n      y: (bounds.height - defaultSize.height) / 2\r\n    });\r\n  };\r\n\r\n  var ensureVisibleOnSomeDisplay = function (windowState) {\r\n    var visible = screen.getAllDisplays().some(function (display) {\r\n      return windowWithinBounds(windowState, display.bounds);\r\n    });\r\n    if (!visible) {\r\n      // Window is partially or fully not visible now.\r\n      // Reset it to safe defaults.\r\n      return resetToDefaults(windowState);\r\n    }\r\n    return windowState;\r\n  };\r\n\r\n  var saveState = function () {\r\n    if (!win.isMinimized() && !win.isMaximized()) {\r\n      Object.assign(state, getCurrentPosition());\r\n    }\r\n    userDataDir.write(stateStoreFile, state, { atomic: true });\r\n  };\r\n\r\n  // state = ensureVisibleOnSomeDisplay(restore());\r\n  state = ensureVisibleOnSomeDisplay(resetToDefaults());\r\n\r\n  win = new BrowserWindow(Object.assign({}, options, state));\r\n\r\n  win.on('close', saveState);\r\n\r\n  return win;\r\n}\r\n","// Simple wrapper exposing environment variables to rest of the code.\r\n\r\nimport jetpack from 'fs-jetpack';\r\n\r\n// The variables have been written to `env.json` by the build process.\r\nvar env = jetpack.cwd(__dirname).read('env.json', 'json');\r\n\r\nexport default env;\r\n","import { app, Menu } from 'electron'\nimport createWindow from './lib/window'\nimport env from './env'\n\nvar mainWindow\n\napp.on('ready', function () {\n  var mainWindow = createWindow('main', {\n    // width: 1000,\n    // minWidth: 1000,\n    // height: 618,\n    // minHeight: 618\n    width: 900,\n    minWidth: 900,\n    height: 640,\n    minHeight: 640,\n    autoHideMenuBar: true\n  })\n\n  mainWindow.loadURL('file://' + __dirname + '/app.html')\n\n  if (env.name !== 'production') {\n    mainWindow.openDevTools()\n  }\n})\n\napp.on('window-all-closed', function () {\n  app.quit()\n})\n"],"names":["BrowserWindow","screen","app"],"mappings":"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"}